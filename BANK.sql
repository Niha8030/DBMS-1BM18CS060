CREATE TABLE BRANCH 
(
BRANCH_NAME VARCHAR2(20),
BRANCH_CITY VARCHAR2(20),
ASSETS NUMERIC(15,2),
PRIMARY KEY(BRANCH_NAME)
);
CREATE TABLE ACCOUNTS 
(
ACC_NO NUMERIC(20),
BRANCH_NAME VARCHAR2(20),
BALANCE NUMERIC(15,2),
PRIMARY KEY(ACC_NO)
);

CREATE TABLE CUSTOMER
(
CUSTOMER_NAME VARCHAR2(20),
CITY VARCHAR2(20),
CUSTOMER_STREET VARCHAR2(20),
PRIMARY KEY(CUSTOMER_NAME)
);
CREATE TABLE DEPOSITOR
(
CUSTOMER_NAME VARCHAR2(20),
ACC_NO NUMERIC(20),
PRIMARY KEY(ACC_NO),
FOREIGN KEY(CUSTOMER_NAME)REFERENCES CUSTOMER(CUSTOMER_NAME)
);
CREATE TABLE LOAN 
(
BRANCH_NAME VARCHAR2(20),
LOAN_NO NUMERIC(10),
AMOUNT NUMERIC(15,2),
PRIMARY KEY(LOAN_NO)
);
CREATE TABLE BORROWER 
(
CUSTOMER_NAME VARCHAR2(20),
LOAN_NO NUMERIC(10),
PRIMARY KEY(CUSTOMER_NAME)
);

INSERT INTO BRANCH VALUES('SBI_CHAMRAJPET','BANGALORE',50000);
INSERT INTO BRANCH VALUES('SBI_JANTARMANTAR','DELHI',200000);
INSERT INTO BRANCH VALUES('SBI_RESIDENCYROAD','BANGALORE',100000);
INSERT INTO BRANCH VALUES('SBI_SHIVAJIROAD','BOMBAY',20000);
INSERT INTO BRANCH VALUES('SBI_PARLIMENTROAD','DELHI',10000);

INSERT INTO ACCOUNTS VALUES(1,'SBI_CHAMRAJPET',2000);
INSERT INTO ACCOUNTS VALUES(2,'SBI_JANTARMANTAR',5000);
INSERT INTO ACCOUNTS VALUES(3,'SBI_RESIDENCYROAD',6000);
INSERT INTO ACCOUNTS VALUES(4,'SBI_PARLIMENTROAD',9000);
INSERT INTO ACCOUNTS VALUES(5,'SBI_JANTARMANTAR',8000);
INSERT INTO ACCOUNTS VALUES(6,'SBI_SHIVAJIROAD',4000);
INSERT INTO ACCOUNTS VALUES(7,'SBI_RESIDENCYROAD',4000);
INSERT INTO ACCOUNTS VALUES(8,'SBI_PARLIMENTROAD',3000);
INSERT INTO ACCOUNTS VALUES(9,'SBI_RESIDENCYROAD',5000);
INSERT INTO ACCOUNTS VALUES(10,'SBI_JANTARMANTAR',2000);

INSERT INTO DEPOSITOR VALUES('AVINASH',1);
INSERT INTO DEPOSITOR VALUES('DINESH',2);
INSERT INTO DEPOSITOR VALUES('NIKIL',4);
INSERT INTO DEPOSITOR VALUES('RAVI',5);
INSERT INTO DEPOSITOR VALUES('AVINASH',8);
INSERT INTO DEPOSITOR VALUES('NIKIL',9);
INSERT INTO DEPOSITOR VALUES('DINESH',10);
INSERT INTO DEPOSITOR VALUES('NIKIL',6);

INSERT INTO CUSTOMER VALUES('AVINASH','BULL_TEMPLE_ROAD','BANAGLORE');
INSERT INTO CUSTOMER VALUES('DINESH','BANNERGATTA_ROAD','BANGALORE');
INSERT INTO CUSTOMER VALUES('MOHAN','NATIONALCOLLEGE_ROAD','BANGALORE');
INSERT INTO CUSTOMER VALUES('NIKIL','AKBAR_ROAD','DELHI');
INSERT INTO CUSTOMER VALUES('RAVI','PRITHIVIRAJ_ROAD','DELHI');

INSERT INTO LOAN VALUES('SBI_CHAMRAJPET',1,1000);
INSERT INTO LOAN VALUES('SBI_RESIDENCYROAD',2,2000);
INSERT INTO LOAN VALUES('SBI_SHIVAJIROAD',3,3000);
INSERT INTO LOAN VALUES('SBI_PARLIMENTROAD',4,4000);
INSERT INTO LOAN VALUES('SBI_JANTARMANTAR',5,5000);




SELECT C.CUSTOMER_NAME
FROM CUSTOMER C
WHERE EXISTS(
             SELECT D.CUSTOMER_NAME,COUNT(D.CUSTOMERNAME)
             FROM DEPOSITOR D,ACCOUNTS A
             WHERE D.ACC_NO=A.ACC_NO AND
                   C.CUSTOMER_NAME=D.CUSTOMER_NAME AND
                   A.BRANCH_NAME='SBI_RESIDENCYROAD'
             GROUP BY D.CUSTOMER_NAME
             HAVING COUNT(D.CUSTOMER_NAME)>=2;
  );


SELECT C.CUSTOMER_NAME
FROM CUSTOMER C
WHERE NOT EXISTS( 
                 SELECT BRANCH_NAME FROM BRANCH WHERE CITY='DELHI'
                 MINUS
                 (SELECT A.BRANCH_NAME FROM DEPOSITOR D,ACCOUNT A
                  WHERE D.ACC_NO=A.ACC_NO AND C.CUSTOMER_NAME=D.CUSTOMER_NAME));
                  
DELETE FROM ACCOUNT
WHERE BRANCH_NAME IN (SELECT BRANCH_NAME 
                      FROM BRANCH
                      WHERE CITY='BOMBAY');
                  
                  
